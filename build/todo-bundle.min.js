!function(){"use strict";function n(){for(var n,r=0,e=arguments.length,o={};r<e;++r){if(!(n=arguments[r]+"")||n in o)throw new Error("illegal type: "+n);o[n]=[]}return new t(o)}function t(n){this._=n}function r(n,t){return n.trim().split(/^|\s+/).map(function(n){var r="",e=n.indexOf(".");if(e>=0&&(r=n.slice(e+1),n=n.slice(0,e)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}function e(n,t){for(var r,e=0,o=n.length;e<o;++e)if((r=n[e]).name===t)return r.value}function o(n,t,r){for(var e=0,o=n.length;e<o;++e)if(n[e].name===t){n[e]=i,n=n.slice(0,e).concat(n.slice(e+1));break}return null!=r&&n.push({name:t,value:r}),n}var i={value:function(){}};t.prototype=n.prototype={constructor:t,on:function(n,t){var i,a=this._,l=r(n+"",a),u=-1,f=l.length;{if(!(arguments.length<2)){if(null!=t&&"function"!=typeof t)throw new Error("invalid callback: "+t);for(;++u<f;)if(i=(n=l[u]).type)a[i]=o(a[i],n.name,t);else if(null==t)for(i in a)a[i]=o(a[i],n.name,null);return this}for(;++u<f;)if((i=(n=l[u]).type)&&(i=e(a[i],n.name)))return i}},copy:function(){var n={},r=this._;for(var e in r)n[e]=r[e].slice();return new t(n)},call:function(n,t){if((r=arguments.length-2)>0)for(var r,e,o=new Array(r),i=0;i<r;++i)o[i]=arguments[i+2];if(!this._.hasOwnProperty(n))throw new Error("unknown type: "+n);for(e=this._[n],i=0,r=e.length;i<r;++i)e[i].value.apply(t,o)},apply:function(n,t,r){if(!this._.hasOwnProperty(n))throw new Error("unknown type: "+n);for(var e=this._[n],o=0,i=e.length;o<i;++o)e[o].value.apply(t,r)}};var a=function(t){var r=n("changed"),e=[];t.on("item-add",function(){e.push("todo"),r.call("changed")}),t.on("item-remove",function(){e.pop(),r.call("changed")});var o={getState:function(){return e},on:function(){var n=r.on.apply(r,arguments);return n===r?o:n}};return o},l=function(t){var r=n("item-add","item-remove"),e=new a(r);e.on("changed",function(){console.log("todos",e.getState())}),r.call("add"),r.call("add")};l("#app")}();